# Анализ проекта GAS-2025 - Компилятор собственного языка программирования

## Общая информация

**Название проекта:** GAS-2025  
**Тип проекта:** Компилятор для собственного процедурного языка программирования  
**Язык реализации:** C++  
**Платформа:** Windows (Visual Studio 2022)  
**Целевая платформа:** x86/x64 (MASM ассемблер)

---

## Архитектура проекта

### Структура решения

Проект состоит из 3 основных компонентов:

1. **GAS-2025** - основной компилятор (C++)
2. **StaticLibrary** - статическая библиотека со стандартными функциями
3. **Assembler** - проект для сборки ассемблерного кода

### Конвейер компиляции

```
Исходный код (.txt)
    ↓
[1] Лексический анализ (LexAnalysis)
    ↓
[2] Синтаксический анализ (MFST - Модифицированная Формальная Система)
    ↓
[3] Семантический анализ (SemAnalysis)
    ↓
[4] Преобразование в польскую нотацию (PolishNotation)
    ↓
[5] Генерация кода (Generator) → Ассемблер (.asm)
    ↓
[6] Компиляция MASM (ml.exe) → Объектный файл (.obj)
    ↓
[7] Линковка (link.exe) → Исполняемый файл (.exe)
```

---

## Модульная архитектура

### Основные модули компилятора

#### 1. **Ввод и обработка входных данных**
- **In.h/In.cpp** - чтение исходного файла, разбиение на слова
- **Parm.h/Parm.cpp** - обработка параметров командной строки
- **Log.h/Log.cpp** - система логирования

#### 2. **Лексический анализ**
- **LexAnalysis.h/LexAnalysis.cpp** - токенизация исходного кода
- **FST.h/FST.cpp** - конечные автоматы для распознавания лексем
- **LT.h/LT.cpp** - таблица лексем (LexTable)
- **IT.h/IT.cpp** - таблица идентификаторов (IdTable)

#### 3. **Синтаксический анализ**
- **MFST.h/MFST.cpp** - Модифицированная Формальная Система (аналог LL-парсера)
- **GRB.h/GRB.cpp** - Грамматика Грейбаха (нормальная форма)
- **Graphs.h** - вспомогательные структуры

#### 4. **Семантический анализ**
- **SemAnalysis.h/SemAnalysis.cpp** - проверка типов, области видимости, семантических правил

#### 5. **Преобразование выражений**
- **PolishNotation.h/PolishNotation.cpp** - преобразование арифметических выражений в обратную польскую нотацию

#### 6. **Генерация кода**
- **Generator.h/Generator.cpp** - генерация MASM ассемблерного кода

#### 7. **Обработка ошибок**
- **Error.h/Error.cpp** - система обработки и вывода ошибок

---

## Описание языка программирования

### Типы данных
- `number` - целое число (short, -32768..32767)
- `line` - строка (максимум 255 символов)
- `char` - символ (1 байт)
- `proc` - процедура (void функция)

### Ключевые слова
- `new` - объявление переменных
- `function` - объявление функции с возвращаемым значением
- `proc function` - объявление процедуры
- `main` - точка входа
- `is:`, `istrue`, `isfalse` - условный оператор
- `do` - цикл
- `return` - возврат из функции
- `output` - вывод
- `nextline` - новая строка

### Операторы

**Арифметические:**
- `+`, `-`, `*`, `/`, `%`

**Сравнения (только для number):**
- `>` (больше), `<` (меньше)
- `&` (равно), `!` (не равно)
- `~` (больше или равно), `@` (меньше или равно)

### Стандартные функции
- `concat(line a, line b)` → line
- `compare(line a, line b)` → number
- `rnd(number min, number max)` → number
- `aton(line str)` → number
- `slength(line str)` → number

---

## Особенности реализации

### Лексический анализ
- Использует конечные автоматы (FST) для распознавания лексем
- Поддержка идентификаторов до 16 символов
- Распознавание шестнадцатеричных литералов (0x...)
- Максимальный размер таблицы лексем: 4096

### Синтаксический анализ
- Использует грамматику в нормальной форме Грейбаха
- MFST (Модифицированная Формальная Система) - алгоритм разбора
- Поддержка функций, условных операторов, циклов
- Система диагностики ошибок разбора

### Семантический анализ
- Проверка совместимости типов при присваивании
- Проверка количества и типов параметров функций
- Проверка области видимости переменных
- Максимум 3 параметра в функции

### Генерация кода
- Целевая платформа: x86/x64 (MASM)
- Используется стековая модель вычислений
- Поддержка обратной польской нотации
- Генерация 32-битного кода
- Интеграция со стандартной библиотекой через StaticLibrary.lib

---

## Структура данных

### LexTable (LT)
- Хранит последовательность лексем
- Каждая запись: тип лексемы, номер строки, индекс в IdTable

### IdTable (IT)
- Хранит идентификаторы (переменные, функции, литералы)
- Типы записей: V (переменная), F (функция), P (параметр), L (литерал), S (стандартная функция)
- Поддержка области видимости через scoped идентификаторы

### Грамматика (GRB)
- Правила в формате: нетерминал → цепочка терминалов/нетерминалов
- 16 правил грамматики для основных конструкций языка

---

## Процесс сборки

### Автоматизация (run.bat)
1. Запуск компилятора GAS-2025.exe с входным файлом
2. Генерация ассемблерного кода (out.asm)
3. Компиляция MASM (ml /c /coff /Zi out.asm)
4. Линковка с библиотеками (link)
5. Запуск сгенерированной программы

### Зависимости
- Visual Studio 2022 (ml.exe, link.exe)
- StaticLibrary.lib - стандартные функции
- libucrt.lib, kernel32.lib - системные библиотеки Windows

---

## Сильные стороны проекта

1. ✅ **Модульная архитектура** - четкое разделение на компоненты
2. ✅ **Полнота реализации** - все этапы компиляции реализованы
3. ✅ **Обработка ошибок** - система диагностики на всех этапах
4. ✅ **Логирование** - подробное логирование процесса компиляции
5. ✅ **Документация** - описание языка в ЯЗЫК_ПРОГРАММИРОВАНИЯ.md
6. ✅ **Функциональность** - поддержка функций, циклов, условий, типов данных
7. ✅ **Генерация кода** - полная генерация исполняемого кода

---

## Потенциальные области улучшения

### Производительность
- [ ] Оптимизация работы с большими файлами
- [ ] Кэширование результатов лексического анализа

### Функциональность
- [ ] Расширение типов данных (массивы, структуры)
- [ ] Поддержка рекурсии
- [ ] Расширение стандартной библиотеки
- [ ] Поддержка строковых операций (подстроки, замена)

### Обработка ошибок
- [ ] Более информативные сообщения об ошибках
- [ ] Поддержка множественных ошибок (сейчас останавливается на первой)

### Генерация кода
- [ ] Оптимизация генерируемого кода
- [ ] Поддержка 64-битных операций
- [ ] Оптимизация использования регистров

### Тестирование
- [ ] Набор unit-тестов
- [ ] Интеграционные тесты
- [ ] Тесты на граничные случаи

### Код
- [ ] Рефакторинг длинных функций (Generator.cpp - 729 строк)
- [ ] Использование современных конструкций C++ (smart pointers, STL контейнеры)
- [ ] Улучшение читаемости кода (комментарии на английском/русском)
- [ ] Устранение магических чисел через константы

---

## Метрики проекта

### Размер кодовой базы
- Основной проект: ~20 исходных файлов (.cpp/.h)
- Общий объем кода: ~5000+ строк
- Максимальный размер таблиц: 4096 записей

### Ограничения
- Максимальная длина идентификатора: 16 символов
- Максимальная длина строки: 255 символов
- Максимальное количество параметров функции: 3
- Диапазон чисел: -32768 до 32767
- Максимальный размер таблиц: 4096

---

## Примеры использования

### Пример 1: Простая программа
```
main[
    new number x = 5;
    new number y = 10;
    output x + y;
    nextline;
]
```

### Пример 2: Функция с условием
```
number function max(number x, number y)
[
    is: x > y #
    istrue [return x;]
    isfalse [return y;]#
]

main[
    new number result = max(5, 10);
    output result;
    nextline;
]
```

### Пример 3: Цикл
```
main[
    new number i = 0;
    is: i < 10 #
    do [
        output i;
        output " ";
        i = i + 1;
    ]#
    nextline;
]
```

---

## Выводы

Проект представляет собой **полнофункциональный компилятор** для процедурного языка программирования с четкой архитектурой и реализацией всех основных этапов компиляции. Код хорошо структурирован, использует модульный подход и включает систему обработки ошибок и логирования.

Проект демонстрирует понимание:
- Лексического анализа
- Синтаксического анализа (MFST)
- Семантического анализа
- Преобразования выражений
- Генерации кода

Для учебного проекта это очень качественная реализация, показывающая глубокое понимание принципов построения компиляторов.

